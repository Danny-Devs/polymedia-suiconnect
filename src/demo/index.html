<!DOCTYPE html>
<html>
<head>
    <title>SuiConnect Demo</title>
    <!-- 1. Load SuiConnect CSS -->
    <link rel="stylesheet" href="https://suiconnect.polymedia.app/assets/index-Ci8EKbxv.css">
</head>
<body>
    <h2>SuiConnect Demo</h2>

    <!-- 2. The wallet button will appear here -->
    <div id="suiconnect-root"></div>

    <!-- 3. Load SuiConnect -->
    <script defer src="https://31d0d636.polymedia-suiconnect.pages.dev/assets/index-Cil4I9Wj.js" onload="window.suiconnectInit()"></script>

    <!-- 4. Handle wallet connections -->
    <script>
        window.addEventListener("suiconnect-wallet-change", (event) => {
            const {
                address, // string or null when not connected
                client, // SuiClient instance
                signTransaction, // prompt the user to sign a tx with their wallet
                signAndExecuteTransaction, // prompt the user to sign and execute a tx with their wallet
                signPersonalMessage, // prompt the user to sign and execute a tx with their wallet
                Transaction, // Transaction class
            } = event.detail;

            // address is a string or null when not connected
            console.log("[handler] connected wallet:", address);

            // client is a SuiClient instance
            client.getLatestSuiSystemState().then(state => {
                console.log("[handler] current epoch:", state.epoch);
            });

            if (!address) return;

            // prompt the user to sign a message with their wallet
            signPersonalMessage({
                message: new TextEncoder().encode("Hey hey hey SuiConnect!"),
            }).then(result => {
                console.log("[handler] sign success:", result);
            }).catch(error => {
                console.warn("[handler] sign failed:", error);
            });

            // prompt the user to approve a transaction with their wallet
            // signAndExecuteTransaction({
            //     transaction: new Transaction(), // a tx that does nothing
            // }).then(result => {
            //     console.log("[handler] tx result:", result);
            // }).catch(error => {
            //     console.warn("[handler] tx error:", error);
            // });
        });
    </script>
</body>
</html>
